<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.2',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.json',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="验证器：Validator使用验证器处理数据不合法错误：比如用户名长度必须在5-20之间，而且必须以字母开头，可包含字母、数字、下划线；比如注册用户时 用户名已经存在或邮箱已经存在等；比如去一些论坛经常会发现，您发的帖子中包含×××屏蔽关键字等。验证器接口Validator12345678package org.springframework.validation;  &#x2F;&#x2F;编程实现数据验证的接口p">
<meta property="og:type" content="website">
<meta property="og:title" content="JJT-个人Wiki">
<meta property="og:url" content="https:&#x2F;&#x2F;hexo-pages-1300861231.cos-website.ap-shanghai.myqcloud.com&#x2F;quotes&#x2F;Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0&#x2F;26-%E9%AA%8C%E8%AF%81%E5%99%A8%E5%8F%8AJSR-303%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6.html">
<meta property="og:site_name" content="JJT-个人Wiki">
<meta property="og:description" content="验证器：Validator使用验证器处理数据不合法错误：比如用户名长度必须在5-20之间，而且必须以字母开头，可包含字母、数字、下划线；比如注册用户时 用户名已经存在或邮箱已经存在等；比如去一些论坛经常会发现，您发的帖子中包含×××屏蔽关键字等。验证器接口Validator12345678package org.springframework.validation;  &#x2F;&#x2F;编程实现数据验证的接口p">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;hexo-1300861231.cos.ap-shanghai.myqcloud.com&#x2F;1584802913_20200321225638446_6596.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;hexo-1300861231.cos.ap-shanghai.myqcloud.com&#x2F;1584802912_20200321225638235_11916.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;hexo-1300861231.cos.ap-shanghai.myqcloud.com&#x2F;1584802912_20200321225638025_26311.png">
<meta property="og:updated_time" content="2020-12-15T11:07:33.040Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;hexo-1300861231.cos.ap-shanghai.myqcloud.com&#x2F;1584802913_20200321225638446_6596.jpg">

<link rel="canonical" href="https://hexo-pages-1300861231.cos-website.ap-shanghai.myqcloud.com/quotes/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/26-%E9%AA%8C%E8%AF%81%E5%99%A8%E5%8F%8AJSR-303%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: false,
    isPage: true,
    isArchive: false
  };
</script>

  <title> | JJT-个人Wiki
  </title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JJT-个人Wiki</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">you see see you one day day</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content">
            

  <div class="posts-expand">
    
    
    
    <div class="post-block" lang="zh-CN">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">
</h1>

<div class="post-meta">
  
  <ul class="breadcrumb">
          
            <li><a href="/quotes/">QUOTES</a></li>
            <li><a href="/quotes/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">SPRING学习笔记</a></li>
            <li>26-验证器及JSR-303验证框架</li>
          
  </ul>

</div>

</header>

      
      
      
      <div class="post-body">
          <h1>验证器：Validator</h1><p>使用验证器处理数据不合法错误：</p><p>比如用户名长度必须在5-20之间，而且必须以字母开头，可包含字母、数字、下划线；</p><p>比如注册用户时 用户名已经存在或邮箱已经存在等；</p><p>比如去一些论坛经常会发现，您发的帖子中包含×××屏蔽关键字等。</p><h2 id="验证器接口Validator">验证器接口Validator</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.validation;  </span><br><span class="line"><span class="comment">//编程实现数据验证的接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Validator</span> </span>&#123;  </span><br><span class="line">   <span class="comment">//当前验证器是否支持指定的clazz验证，如果支持返回true即可</span></span><br><span class="line">   <span class="function"><span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; clazz)</span></span>;</span><br><span class="line">   <span class="comment">//验证的具体方法，target参数表示要验证的目标对象（如命令对象），errors表示验证出错后存放错误信息的错误对象</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">validate</span><span class="params">(Object target, Errors errors)</span></span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a>






<h2 id="自定义验证器">自定义验证器</h2>
<p><strong>1. 自定义验证的实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.javass.chapter4.web.controller.support.validator;  </span><br><span class="line"><span class="comment">//省略import  </span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserModelValidator</span> <span class="keyword">implements</span> <span class="title">Validator</span> </span>&#123;  </span><br><span class="line">   <span class="comment">//长度5-20，以字母开头，随后可以是字母、数字、下划线</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Pattern USERNAME_PATTERN = Pattern.compile(<span class="string">"[a-zA-Z]\\w&#123;4,19&#125;"</span>);  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Pattern PASSWORD_PATTERN = Pattern.compile(<span class="string">"[a-zA-Z0-9]&#123;5,20&#125;"</span>);  </span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Set&lt;String&gt; FORBINDDDEN_WORD_SET = <span class="keyword">new</span> HashSet&lt;String&gt;();  </span><br><span class="line">   <span class="keyword">static</span> &#123;  </span><br><span class="line">      FORBINDDDEN_WORD_SET.add(<span class="string">"fuck"</span>);</span><br><span class="line">      FORBINDDDEN_WORD_SET.add(<span class="string">"admin"</span>);  </span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">//表示只对UserModel类型的对象验证</span></span><br><span class="line">   <span class="meta">@Override</span>  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> </span>&#123;  </span><br><span class="line">      <span class="keyword">return</span> UserModel.class == clazz;<span class="comment">//表示只对UserModel类型的目标对象实施验证  </span></span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="comment">//数据验证的具体方法</span></span><br><span class="line">   <span class="meta">@Override</span>  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validate</span><span class="params">(Object target, Errors errors)</span> </span>&#123;  </span><br><span class="line">      <span class="comment">//这个表示如果目标对象的username属性为空，则表示错误（简化我们手工判断是否为空）  </span></span><br><span class="line">      <span class="comment">//内部通过（value == null || !StringUtils.hasLength(value.toString())）实现判断value是否为空</span></span><br><span class="line">      ValidationUtils.rejectIfEmpty(errors, <span class="string">"username"</span>, <span class="string">"username.not.empty"</span>);</span><br><span class="line"> </span><br><span class="line">      UserModel user = (UserModel) target;  </span><br><span class="line">      </span><br><span class="line">      <span class="comment">//使用正则表达式验证</span></span><br><span class="line">      <span class="keyword">if</span>(!USERNAME_PATTERN.matcher(user.getUsername()).matches()) &#123;  </span><br><span class="line">          <span class="comment">//验证失败为username字段添加错误码</span></span><br><span class="line">          errors.rejectValue(<span class="string">"username"</span>, <span class="string">"username.not.illegal"</span>);<span class="comment">//如果用户名不合法  </span></span><br><span class="line">      &#125;  </span><br><span class="line">      </span><br><span class="line">      <span class="comment">//判断我们的用户名中是否含有非法关键词</span></span><br><span class="line">      <span class="keyword">for</span>(String forbiddenWord : FORBINDDDEN_WORD_SET) &#123;  </span><br><span class="line">          <span class="keyword">if</span>(user.getUsername().contains(forbiddenWord)) &#123;</span><br><span class="line">             <span class="comment">//验证失败为username字段添加错误码（参数为当前屏蔽关键词）（默认消息为"您的用户名包含非法关键词"）</span></span><br><span class="line">             errors.rejectValue(<span class="string">"username"</span>, <span class="string">"username.forbidden"</span>, <span class="keyword">new</span> Object[]&#123;forbiddenWord&#125;, <span class="string">"您的用户名包含非法关键词"</span>);<span class="comment">//用户名包含屏蔽关键字  </span></span><br><span class="line">             <span class="keyword">break</span>;  </span><br><span class="line">          &#125;  </span><br><span class="line">      &#125;  </span><br><span class="line">      <span class="keyword">if</span>(!PASSWORD_PATTERN.matcher(user.getPassword()).matches()) &#123;  </span><br><span class="line">          errors.rejectValue(<span class="string">"password"</span>,<span class="string">"password.not.illegal"</span>, <span class="string">"密码不合法"</span>);<span class="comment">//密码不合法  </span></span><br><span class="line">      &#125;    </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>2. Spring中Bean配置</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userModelValidator"</span>  <span class="attr">class</span>=<span class="string">"cn.javass.chapter4.web.controller.support.validator.UserModelValidator"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="使用验证器">使用验证器</h2>
<p><strong>1. Controller中使用验证器</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidatorController</span> </span>&#123;  </span><br><span class="line">   <span class="keyword">private</span> UserModelValidator validator = <span class="keyword">new</span> UserModelValidator();  </span><br><span class="line"> </span><br><span class="line">   <span class="meta">@ModelAttribute</span>(<span class="string">"user"</span>)        <span class="comment">//① 暴露表单引用对象为模型数据  </span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> UserModel <span class="title">getUser</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> UserModel();  </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@RequestMapping</span>(value = <span class="string">"/validator"</span>, method = RequestMethod.GET)  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">showRegisterForm</span><span class="params">()</span> </span>&#123;   <span class="comment">//② 表单展示  </span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"validate/registerAndValidator"</span>;  </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@RequestMapping</span>(value = <span class="string">"/validator"</span>, method = RequestMethod.POST)  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">submitForm</span><span class="params">(@ModelAttribute(<span class="string">"user"</span>)</span> UserModel user, Errors errors) </span>&#123;           <span class="comment">//③ 表单提交  </span></span><br><span class="line">       validator.validate(user, errors);  <span class="comment">//1、调用UserModelValidator的validate方法进行验证，并通过Errors接口来保留错误</span></span><br><span class="line">       <span class="keyword">if</span>(errors.hasErrors()) &#123; <span class="comment">//2、如果有错误再回到表单展示页面  </span></span><br><span class="line">           <span class="keyword">return</span> showRegisterForm();  </span><br><span class="line">       &#125;  </span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;  </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面控制器相关方法没有提供给我们errors对象（Errors），我们应该怎么进行错误处理呢？</p>
<p>errors本质就是一个Errors接口实现，而且在页面要读取相关的错误对象，该错误对象应该存放在模型对象里面，因此我们可以自己创建个errors对象并将其添加到模型对象中即可。</p>
<p><strong>2. 错误消息配置</strong></p>
<p>添加如下错误消息配置：</p>
<ul>
<li>
<p>Spring容器中配置messageSource</p>
</li>
<li>
<p>messages.properties，需要执行NativeToAscii</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">username.not.empty=用户名不能为空  </span><br><span class="line">username.not.illegal=用户名错误，必须以字母开头，只能出现字母、数字、下划线，并且长度在5-20之间  </span><br><span class="line">username.forbidden=用户名中包含非法关键词【&#123;0&#125;】  </span><br><span class="line">password.not.illegal=密码长度必须在5-20之间</span><br></pre></td></tr></table></figure>
<p><strong>3. JSP页面使用form标签库</strong></p>
<p>视图页面</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;  </span><br><span class="line">&lt;%<span class="meta">@taglib</span> prefix=<span class="string">"form"</span> uri=<span class="string">"http://www.springframework.org/tags/form"</span> %&gt;  </span><br><span class="line">&lt;form:form commandName=<span class="string">"user"</span>&gt;  </span><br><span class="line">  </span><br><span class="line">    &lt;form:errors path="*" cssStyle="color:red"&gt;&lt;/form:errors&gt;&lt;br/&gt; </span><br><span class="line">  </span><br><span class="line">    username:&lt;form:input path=<span class="string">"username"</span>/&gt;</span><br><span class="line">    &lt;!-- form:errors path=<span class="string">"username"</span>：表示只显示username字段的错误信息 --&gt;</span><br><span class="line">    &lt;form:errors path="username" cssStyle="color:red"&gt;&lt;/form:errors&gt;&lt;br/&gt; </span><br><span class="line">  </span><br><span class="line">    password:&lt;form:password path=<span class="string">"password"</span>/&gt; </span><br><span class="line">    &lt;form:errors path="password" cssStyle="color:red"&gt;&lt;/form:errors&gt; &lt;br/&gt; </span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> value=<span class="string">"注册"</span>/&gt; </span><br><span class="line">&lt;/form:form&gt;</span><br></pre></td></tr></table></figure>
<p>测试</p>
<p>地址：<a href="http://localhost:9080/springmvc-chapter4/validator" target="_blank" rel="noopener">http://localhost:9080/springmvc-chapter4/validator</a></p>
<p><img src="https://hexo-1300861231.cos.ap-shanghai.myqcloud.com/1584802913_20200321225638446_6596.jpg" alt></p>
<h1>JSR-303验证框架</h1>
<p>从Spring3开始支持JSR-303验证框架，支持XML风格和注解风格的验证，目前在@RequestMapping时才能使用，也就是说基于Controller接口的实现不能使用该方式。</p>
<h2 id="JSR-303验证框架集成">JSR-303验证框架集成</h2>
<p>此处使用Hibernate-validator实现，Maven依赖如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.hibernate.validator/hibernate-validator --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.13.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>1. 配置LocalValidatorFactoryBean</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 以下 validator  ConversionService 在使用 mvc:annotation-driven 会自动注册--&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validator"</span> <span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 此处使用Hibernate validator实现 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"providerClass"</span>  <span class="attr">value</span>=<span class="string">"org.hibernate.validator.HibernateValidator"</span>/&gt;</span>  </span><br><span class="line">   <span class="comment">&lt;!-- validationMessageSource属性指定国际化错误消息从哪里取，此处使用之前定义的messageSource来获取国际化消息；</span></span><br><span class="line"><span class="comment">   如果此处不指定该属性，则默认从classpath下的ValidationMessages.properties取国际化错误消息 --&gt;</span>  </span><br><span class="line">   <span class="comment">&lt;!-- &lt;property name="validationMessageSource" ref="messageSource"/&gt; --&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>2. 注册validator</strong></p>
<p>通过ConfigurableWebBindingInitializer注册validator</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"webBindingInitializer"</span>  <span class="attr">class</span>=<span class="string">"org.springframework.web.bind.support.ConfigurableWebBindingInitializer"</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"conversionService"</span> <span class="attr">ref</span>=<span class="string">"conversionService"</span>/&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validator"</span> <span class="attr">ref</span>=<span class="string">"validator"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后注册ConfigurableWebBindingInitializer到RequestMappingHandlerAdapter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"webBindingInitializer"</span> <span class="attr">ref</span>=<span class="string">"webBindingInitializer"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="JSR-303验证框架的使用">JSR-303验证框架的使用</h2>
<h3 id="内置的验证约束注解">内置的验证约束注解</h3>
<p>内置的验证约束注解如下表所示（摘自hibernate validator reference）：</p>
<table>
<thead>
<tr>
<th>验证注解</th>
<th>验证的数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>@AssertFalse</td>
<td>Boolean,boolean</td>
<td>验证注解的元素值是false</td>
</tr>
<tr>
<td>@AssertTrue</td>
<td>Boolean,boolean</td>
<td>验证注解的元素值是true</td>
</tr>
<tr>
<td>@NotNull</td>
<td>任意类型</td>
<td>验证注解的元素值不是null</td>
</tr>
<tr>
<td>@Null</td>
<td>任意类型</td>
<td>验证注解的元素值是null</td>
</tr>
<tr>
<td>@Min(value=值)</td>
<td>BigDecimal，BigInteger, byte, short, int, long，等任何Number或CharSequence（存储的是数字）子类型</td>
<td>验证注解的元素值大于等于@Min指定的value值</td>
</tr>
<tr>
<td>@Max（value=值）</td>
<td>和@Min要求一样</td>
<td>验证注解的元素值小于等于@Max指定的value值</td>
</tr>
<tr>
<td>@DecimalMin(value=值)</td>
<td>和@Min要求一样</td>
<td>验证注解的元素值大于等于@ DecimalMin指定的value值</td>
</tr>
<tr>
<td>@DecimalMax(value=值)</td>
<td>和@Min要求一样</td>
<td>验证注解的元素值小于等于@ DecimalMax指定的value值</td>
</tr>
<tr>
<td>@Digits(integer=整数位数, fraction=小数位数)</td>
<td>和@Min要求一样</td>
<td>验证注解的元素值的整数位数和小数位数上限</td>
</tr>
<tr>
<td>@Size(min=下限, max=上限)</td>
<td>字符串、Collection、Map、数组等</td>
<td>验证注解的元素值的在min和max（包含）指定区间之内，如字符长度、集合大小</td>
</tr>
<tr>
<td>@Past</td>
<td>java.util.Date, java.util.Calendar; Joda Time类库的日期类型</td>
<td>验证注解的元素值（日期类型）比当前时间早</td>
</tr>
<tr>
<td>@Future</td>
<td>与@Past要求一样</td>
<td>验证注解的元素值（日期类型）比当前时间晚</td>
</tr>
<tr>
<td>@NotBlank</td>
<td>CharSequence子类型</td>
<td>验证注解的元素值不为空（不为null、去除首位空格后长度为0），不同于@NotEmpty，@NotBlank只应用于字符串且在比较时会去除字符串的首位空格</td>
</tr>
<tr>
<td>@Length(min=下限, max=上限)</td>
<td>CharSequence子类型</td>
<td>验证注解的元素值长度在min和max区间内</td>
</tr>
<tr>
<td>@NotEmpty</td>
<td>CharSequence子类型、Collection、Map、数组</td>
<td>验证注解的元素值不为null且不为空（字符串长度不为0、集合大小不为0）</td>
</tr>
<tr>
<td>@Range(min=最小值, max=最大值)</td>
<td>BigDecimal,BigInteger,CharSequence, byte, short, int, long等原子类型和包装类型</td>
<td>验证注解的元素值在最小值和最大值之间</td>
</tr>
<tr>
<td>@Email(regexp=正则表达式, flag=标志的模式)</td>
<td>CharSequence子类型（如String）</td>
<td>验证注解的元素值是Email，也可以通过regexp和flag指定自定义的email格式</td>
</tr>
<tr>
<td>@Pattern(regexp=正则表达式, flag=标志的模式)</td>
<td>String，任何CharSequence的子类型</td>
<td>验证注解的元素值与指定的正则表达式匹配</td>
</tr>
<tr>
<td>@Valid</td>
<td>任何非原子类型</td>
<td>指定递归验证关联的对象； 如用户对象中有个地址对象属性，如果想在验证用户对象时一起验证地址对象的话，在地址对象上加@Valid注解即可级联验证</td>
</tr>
</tbody>
</table>
<p>此处只列出Hibernate Validator提供的大部分验证约束注解，请参考hibernate validator官方文档了解其他验证约束注解和进行自定义的验证约束注解定义。</p>
<h3 id="使用示例">使用示例</h3>
<p><strong>1. 模型字段上指定验证信息</strong></p>
<p>示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.javass.chapter7.model;  </span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserModel</span> </span>&#123;  </span><br><span class="line"> </span><br><span class="line">   <span class="meta">@NotNull</span>(message=<span class="string">"&#123;username.not.empty&#125;"</span>)  </span><br><span class="line">   <span class="keyword">private</span> String username;  </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过@NotNull指定此username字段不允许为空，当验证失败时将从之前指定的messageSource中获取“username.not.empty”对应的错误信息，此处只有通过“{错误消息键值}”格式指定的才能从messageSource获取。</p>
<p><strong>2. 命令对象上进行JSR-303验证</strong></p>
<p>示例代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.javass.chapter7.web.controller.validate;  </span><br><span class="line"><span class="comment">//省略import  </span></span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line">   <span class="meta">@RequestMapping</span>(<span class="string">"/validate/hello"</span>)  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">validate</span><span class="params">(@Valid @ModelAttribute(<span class="string">"user"</span>)</span> UserModel user, Errors errors) </span>&#123;  </span><br><span class="line">       <span class="keyword">if</span>(errors.hasErrors()) &#123;  </span><br><span class="line">           <span class="keyword">return</span> <span class="string">"validate/error"</span>;  </span><br><span class="line">       &#125;  </span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过在命令对象上注解@Valid来告诉Spring MVC此命令对象在绑定完毕后需要进行JSR-303验证，如果验证失败会将错误信息添加到errors错误对象中。</p>
<h3 id="功能处理方法上多个验证参数的处理">功能处理方法上多个验证参数的处理</h3>
<p>当我们在一个功能处理方法上需要验证多个模型对象时，需要通过如下形式来获取验证结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/validate/multi"</span>)  </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">multi</span><span class="params">(@Valid @ModelAttribute(<span class="string">"a"</span>)</span> A a, BindingResult aErrors, @Valid @<span class="title">ModelAttribute</span><span class="params">(<span class="string">"b"</span>)</span> B b, BindingResult bErrors) </span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(aErrors.hasErrors()) &#123; <span class="comment">//如果a模型对象验证失败  </span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"validate/error"</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">if</span>(bErrors.hasErrors()) &#123; <span class="comment">//如果a模型对象验证失败  </span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"validate/error"</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每一个模型对象后边都需要跟一个Errors或BindingResult对象来保存验证结果，其方法体内部可以使用这两个验证结果对象来选择出错时跳转的页面。详见 <a href="22-SpringMVC.md">MultiModelController</a>。</p>
<p>在错误页面，需要针对不同的模型来显示错误消息：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form:form</span> <span class="attr">commandName</span>=<span class="string">"a"</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">form:errors</span> <span class="attr">path</span>=<span class="string">"*"</span> <span class="attr">cssStyle</span>=<span class="string">"color:red"</span>&gt;</span><span class="tag">&lt;/<span class="name">form:errors</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form:form</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form:form</span> <span class="attr">commandName</span>=<span class="string">"b"</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">form:errors</span> <span class="attr">path</span>=<span class="string">"*"</span> <span class="attr">cssStyle</span>=<span class="string">"color:red"</span>&gt;</span><span class="tag">&lt;/<span class="name">form:errors</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">form:form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="错误消息配置">错误消息配置</h2>
<h3 id="默认的错误消息">默认的错误消息</h3>
<p>默认的错误消息配置文件是/org/hibernate/validator/ValidationMessages.properties，如下图所示：</p>
<p><img src="https://hexo-1300861231.cos.ap-shanghai.myqcloud.com/1584802912_20200321225638235_11916.jpg" alt></p>
<p>默认的错误消息键值如下图所示：</p>
<p><img src="https://hexo-1300861231.cos.ap-shanghai.myqcloud.com/1584802912_20200321225638025_26311.png" alt></p>
<p>消息键默认为：验证约束注解的全限定类名.message</p>
<h3 id="自定义错误消息源">自定义错误消息源</h3>
<p>自定义的错误消息文件里的错误消息键值将覆盖默认的错误消息文件中的错误消息键值。</p>
<p><strong>1. 自定义错误消息配置文件ValidationMessages.properties</strong></p>
<p>在类装载路径的根下创建ValidationMessages.properties文件，如在src目录下创建会自动复制到类装载路径的根下，并添加如下消息键值（需要native2ascii，可以在eclipse里装Properties Editor，自动保存为ASCII码）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javax.validation.constraints.Pattern.message=用户名必须以字母或下划线开头，后边可以跟字母数字下划线，长度在5-20之间</span><br></pre></td></tr></table></figure>
<p>然后，需要在你的spring配置文件WEB-INF/chapter7-servlet.xml修改之前的validator Bean：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validator"</span> <span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"providerClass"</span> <span class="attr">value</span>=<span class="string">"org.hibernate.validator.HibernateValidator"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时错误消息键值的查找会先到classpath下ValidationMessages.properties中找，找不到再到默认的错误消息文件中找。</p>
<p>输入测试地址：<a href="http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan%EF%BC%8C%E5%B0%86%E7%9C%8B%E5%88%B0%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E6%98%BE%E7%A4%BA%E5%87%BA%E6%9D%A5%E4%BA%86%E3%80%82" target="_blank" rel="noopener">http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan，将看到我们自定义的错误消息显示出来了。</a></p>
<p><strong>2. 自定义messageSource</strong></p>
<ul>
<li>
<p>Spring容器中配置messageSource</p>
</li>
<li>
<p>在spring配置文件WEB-INF/chapter7-servlet.xml定义的validator Bean中，添加如下属性：</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationMessageSource"</span> <span class="attr">ref</span>=<span class="string">"messageSource"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>验证失败的错误消息键值的查找将使用messageSource Bean进行。</p>
<ul>
<li>自定义错误消息</li>
</ul>
<p>在消息文件src/messages.properties中添加如下错误消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javax.validation.constraints.Pattern.message=用户名必须以字母或下划线开头，后边可以跟字母数字下划线，长度在5-20之间</span><br></pre></td></tr></table></figure>
<p>输入测试地址：<a href="http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan%EF%BC%8C%E5%B0%86%E7%9C%8B%E5%88%B0%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E6%98%BE%E7%A4%BA%E5%87%BA%E6%9D%A5%E4%BA%86%E3%80%82" target="_blank" rel="noopener">http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan，将看到我们自定义的错误消息显示出来了。</a></p>
<h3 id="自定义错误消息">自定义错误消息</h3>
<p>我们可以通过验证约束注解的message属性指定错误消息键，格式如“{消息键}”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.javass.chapter7.web.controller.validate.model;  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PatternModel</span> </span>&#123;   </span><br><span class="line">   <span class="meta">@Pattern</span>(regexp = <span class="string">"^[a-zA-Z_][\\w]&#123;4,19&#125;$"</span>, message=<span class="string">"&#123;user.name.error&#125;"</span>)  </span><br><span class="line">   <span class="keyword">private</span> String value;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在消息文件src/messages.properties中添加如下错误消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.name.error=用户名格式不合法</span><br></pre></td></tr></table></figure>
<p>输入测试地址：<a href="http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan%EF%BC%8C%E5%B0%86%E7%9C%8B%E5%88%B0%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E6%98%BE%E7%A4%BA%E5%87%BA%E6%9D%A5%E4%BA%86%E3%80%82" target="_blank" rel="noopener">http://localhost:9080/springmvc-chapter7/validate/pattern?value=zhan，将看到我们自定义的错误消息显示出来了。</a></p>
<h3 id="错误消息占位符">错误消息占位符</h3>
<p>接下来我们看下如下场景</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Length</span>(min=<span class="number">5</span>, max=<span class="number">20</span>, message=<span class="string">"&#123;user.name.length.error&#125;"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.name.error=用户名长度必须在5-20之间</span><br></pre></td></tr></table></figure>
<p>错误消息中的5-20应该是从@Length验证约束注解中获取的，而不是在错误消息中硬编码，因此我们需要占位符的支持：如@Length(min=5, max=20, message=“{user.name.length.error}”)，错误消息可以这样写：用户名长度必须在{min}-{max}之间</p>
<p><strong>错误消息占位符规则</strong>：{验证注解属性名}，如@Length有min和max属性，则在错误消息文件中可以通过{min}和{max}来获取；如@Max有value属性，则在错误消息文件中可以通过{value}来获取。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.name.length.error=用户名长度必须在&#123;min&#125;-&#123;max&#125;之间</span><br></pre></td></tr></table></figure>
<p>输入测试地址：<a href="http://localhost:9080/springmvc-chapter7/validate/length?value=1%EF%BC%8C%E5%B0%86%E7%9C%8B%E5%88%B0%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E6%98%BE%E7%A4%BA%E5%87%BA%E6%9D%A5%E4%BA%86%E3%80%82" target="_blank" rel="noopener">http://localhost:9080/springmvc-chapter7/validate/length?value=1，将看到我们自定义的错误消息显示出来了。</a></p>

      </div>
      
      
      
    </div>
    
  <ul class="breadcrumb">
          
            <li><a href="/quotes/">QUOTES</a></li>
            <li><a href="/quotes/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">SPRING学习笔记</a></li>
            <li>26-验证器及JSR-303验证框架</li>
          
  </ul>

    
    
    
  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-text">验证器：Validator</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#验证器接口Validator"><span class="nav-text">验证器接口Validator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自定义验证器"><span class="nav-text">自定义验证器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用验证器"><span class="nav-text">使用验证器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#null"><span class="nav-text">JSR-303验证框架</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JSR-303验证框架集成"><span class="nav-text">JSR-303验证框架集成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSR-303验证框架的使用"><span class="nav-text">JSR-303验证框架的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#内置的验证约束注解"><span class="nav-text">内置的验证约束注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用示例"><span class="nav-text">使用示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#功能处理方法上多个验证参数的处理"><span class="nav-text">功能处理方法上多个验证参数的处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#错误消息配置"><span class="nav-text">错误消息配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#默认的错误消息"><span class="nav-text">默认的错误消息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义错误消息源"><span class="nav-text">自定义错误消息源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义错误消息"><span class="nav-text">自定义错误消息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#错误消息占位符"><span class="nav-text">错误消息占位符</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="jiateng.jiang"
    src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">jiateng.jiang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jiateng.jiang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.2
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  






  <script src="/js/local-search.js"></script>








<script>
if (document.querySelectorAll('div.pdf').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js', () => {
    document.querySelectorAll('div.pdf').forEach(element => {
      PDFObject.embed(element.getAttribute('target'), element, {
        pdfOpenParams: {
          navpanes: 0,
          toolbar: 0,
          statusbar: 0,
          pagemode: 'thumbs',
          view: 'FitH'
        },
        PDFJS_URL: '/lib/pdf/web/viewer.html',
        height: element.getAttribute('height') || '100%'
      });
    });
  }, window.PDFObject);
}
</script>





  

  

  

</body>
</html>
